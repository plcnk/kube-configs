---
global:
  image:
    repository: ghcr.io/goauthentik/server
    tag: 2024.6.3
  env:
    - name: AUTHENTIK_SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: secret-key
          key: secret_key
    - name: AUTHENTIK_POSTGRESQL__PASSWORD
      valueFrom:
        secretKeyRef:
          name: cnpg-authentik-app
          key: password

authentik:
  # This sends anonymous usage-data, stack traces on errors and
  # performance data to sentry.io, and is fully opt-in
  error_reporting:
    enabled: false
  postgresql:
    host: "cnpg-authentik-rw"

server:
  replicas: 2
  ingress:
    # Specify kubernetes ingress controller class name
    ingressClassName: nginx
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
    hosts:
      - auth.plcnk.home
    paths:
      - /
    pathType: Prefix
    tls:
      - secretName: authentik-tls
        hosts:
          - auth.plcnk.home
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true

worker:
  replicas: 1

postgresql:
  enabled: false

redis:
  enabled: true
  image:
    registry: docker.io
    repository: bitnami/redis
    tag: 7.2.5-debian-12-r4
